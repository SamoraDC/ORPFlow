[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid
childlogdir=/var/log/supervisor

# ============================================================================
# Market Data + Strategy Engine (Unified Rust Binary)
# Jane Street Style: Single binary, no Python in hot path
# Handles: WebSocket, Order Book, Strategy, Paper Trading, REST API (port 8000)
#
# Note: Rust binary reads environment variables directly from the system,
# no need to pass them via supervisor's environment directive.
# ============================================================================
[program:market-data]
command=/app/bin/market-data
directory=/app
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/market-data.err.log
stdout_logfile=/var/log/supervisor/market-data.out.log
priority=100
startsecs=5
startretries=3

# ============================================================================
# OCaml Risk Gateway
# Handles: Position limits, risk validation, IPC with market-data
# ============================================================================
[program:risk-gateway]
command=/app/bin/risk_gateway
directory=/app
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/risk-gateway.err.log
stdout_logfile=/var/log/supervisor/risk-gateway.out.log
priority=200
startsecs=5
startretries=3

# Note: Python strategy service REMOVED
# Strategy logic is now integrated into the unified Rust binary (market-data)
# This follows Jane Street architecture: No interpreted languages in the hot path
