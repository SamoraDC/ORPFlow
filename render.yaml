# Render Blueprint - ORPflow HFT Paper Trading
# Rust + OCaml with ONNX ML Inference (Jane Street Style)
# https://render.com/docs/blueprint-spec

services:
  # Main Trading Service (Web Service for API access)
  - type: web
    name: orp-flow-trading
    runtime: docker
    dockerfilePath: ./Dockerfile
    dockerContext: .
    region: oregon  # Closest to major exchanges
    plan: starter   # $7/month - always on, no spin-down

    # Health check configuration
    healthCheckPath: /health

    # Environment Variables
    envVars:
      # Logging
      - key: RUST_LOG
        value: info

      # Trading Configuration
      - key: SYMBOLS
        value: BTCUSDT,ETHUSDT
      - key: INITIAL_BALANCE
        value: "10000"
      - key: IMBALANCE_THRESHOLD
        value: "0.3"
      - key: MIN_CONFIDENCE
        value: "0.6"
      - key: POSITION_SIZE_PCT
        value: "0.1"

      # Database
      - key: DATABASE_URL
        value: sqlite:///data/trades.db

      # IPC
      - key: IPC_SOCKET_PATH
        value: /tmp/orp-flow.sock

      # Risk Management
      - key: RISK_MAX_POSITION
        value: "1.0"
      - key: RISK_MAX_DRAWDOWN
        value: "0.05"
      - key: MAX_DAILY_TRADES
        value: "50"

      # General
      - key: TIMEZONE
        value: America/Sao_Paulo
      - key: PAPER_TRADING
        value: "true"

      # ONNX ML Inference Configuration
      - key: ONNX_MODEL_DIR
        value: /app/models/onnx
      - key: ML_ENABLED
        value: "true"

      # Telegram notifications (optional - set in dashboard)
      - key: TELEGRAM_BOT_TOKEN
        sync: false  # Must be set manually in dashboard
      - key: TELEGRAM_CHAT_ID
        sync: false  # Must be set manually in dashboard

    # Persistent disk for database
    disk:
      name: orp-flow-data
      mountPath: /data
      sizeGB: 1

    # Auto-deploy on push to main
    autoDeploy: true
